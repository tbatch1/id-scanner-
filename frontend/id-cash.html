<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Redirecting to Scanner...</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #0d111b;
            color: #f4f6ff;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
    </style>
</head>
<body>
    <p>Redirecting to scanner...</p>
    <script>
        // Parse query parameters from the current URL (of the iframe)
        const urlParams = new URLSearchParams(window.location.search);
        const saleId = urlParams.get('sale_id');
        const clerkId = urlParams.get('employee_id');
        const outletId = urlParams.get('outlet_id');
        const customerPhone = urlParams.get('customer_phone');

        // Construct the destination URL for the standalone scanner page
        let checkoutUrl = `${window.location.origin}/checkout.html?type=cash`;
        if (saleId) {
            checkoutUrl += `&saleId=${encodeURIComponent(saleId)}`;
        }
        if (clerkId) {
            checkoutUrl += `&clerkId=${encodeURIComponent(clerkId)}`;
        }
        if (outletId) {
            checkoutUrl += `&outletId=${encodeURIComponent(outletId)}`;
        }
        if (customerPhone) {
            checkoutUrl += `&customerPhone=${encodeURIComponent(customerPhone)}`;
        }

        // This is the key part to "break out" of the iframe.
        const redirectorUrl = new URL(`${window.location.origin}/redirect.html`);
        redirectorUrl.searchParams.set('target', checkoutUrl);
        window.location.href = redirectorUrl.href;
    </script>
</body>
</html>
